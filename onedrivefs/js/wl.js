(function(){if(!window.WL&&!window.OneDrive){window.OneDrive={};OneDrive.Constants={WebViewLink:Sb,DownloadLink:Dd};OneDrive.open=function(c){var b=t(c),a=new X(b,Tg);try{a.initialize();a.validateOpenParameters();a.executeOpenOperation()}catch(d){a.processError(d,Pb)}};OneDrive.save=function(c){var b=t(c),a=new X(b,Ug);try{a.initialize();a.validateSaveParameters();a.executeSaveOperation()}catch(d){a.processErrorCallback(d,Pb)}};OneDrive.createOpenButton=function(d){var c=t(d),a=new X(c,Ad);try{a.initialize();a.validateOpenParameters();a.validateButtonParameters();var b=a.createButtonElement();v(b,jc,function(){a.executeOpenOperation()});return b}catch(e){a.processError(e,Pb);return null}};OneDrive.createSaveButton=function(d){var c=t(d),a=new X(c,Gf);try{a.initialize();a.validateSaveParameters();a.validateButtonParameters();var b=a.createButtonElement();v(b,jc,function(){a.executeSaveOperation()});return b}catch(e){a.processErrorCallback(e,Pb);return null}};function X(d,e){var b=this,c=d[Cg];b._internalApp=WL.UnitTests&&typeof c===ob?c:a;b._options=d;b._method=e}X.createButtonElement=function(a,e,d){var b={};b[x]=e;b[y]=d;var c=zd(b,true);a.innerHTML=c.innerHTML;a.id=c.buttonId;a.title=c.buttonTitle;Ed(b,a);return a};X.prototype={initialize:function(){var a=this;if(a._internalApp._status!==Qc){var b=yh();if(!b)throw new Error(Tf.replace(p,a._method));a._internalApp.appInit({client_id:b,interface_method:a._method});vi("Picker SDK initialized with client_id: "+b,ONEDRIVE_PREFIX)}},executeOpenOperation:function(){var b=this,d=b._internalApp,a=b._options,g=b._method,c={mode:sb,resourceType:Rb,select:a[me]?Gc:ab,linkType:a[Pc],interface_method:g},e=a[Wb],f=a[Zb];d.fileDialog(c).then(function(h){var f=a[Pc],g=[],d=h.data||[];for(var c=0;c<d.length;c++){var b=d[c];g[c]={fileName:b.name,link:f===Sb?b.link:b.source,linkType:f,size:b.size,thumbnails:b.images&&b.images.map(function(a){return a.source})||[]}}e(g)},function(a){a.error===eb?tb(f):b.processError(a,Ld)})},executeSaveOperation:function(){var b=this,c=b._internalApp,a=b._options,d=b._method,j=a[ye],f=a[be],h=a[Wb],g=a[ce],i=a[Zb],e={mode:rb,resourceType:Qb,select:ab,interface_method:d};c.fileDialog(e).then(function(e){var a={path:e.data[0].id,element:j,overwrite:Pd,file_name:f,interface_method:d};c.upload(a).then(function(){tb(h)},function(a){b.processErrorCallback(a,Uf)},function(a){tb(g,a.progressPercentage)})},function(a){a.error===eb?tb(i):b.processError(a,Ld)})},validateOpenParameters:function(){j(this._options,[{name:Pc,type:b,optional:true,defaultValue:Sb,allowedValues:[Dd,Sb]},{name:me,type:nb,optional:true,defaultValue:false},{name:Wb,type:d,optional:false},{name:Zb,type:d,optional:true}],this._method)},validateSaveParameters:function(){j(this._options,[{name:be,type:b,optional:true},{name:ye,type:b,optional:false},{name:Wb,type:d,optional:true},{name:ce,type:d,optional:true},{name:Zb,type:d,optional:true},{name:pe,type:d,optional:true}],this._method)},validateButtonParameters:function(){j(this._options,[{name:qe,type:b,optional:true,defaultValue:Kc,allowedValues:[Kc,ag]}],this._method)},createButtonElement:function(){var a=document.createElement("button"),c=this._method===Ad?P:Hc,b=this._options[qe]===Kc?vb:ub;return X.createButtonElement(a,c,b)},processError:function(c,b){var a=pd(uh,this._method,b,JSON.stringify(c));n(a,ONEDRIVE_PREFIX);return a},processErrorCallback:function(b,a){tb(this._options[pe],this.processError(b,a))}};var ii="download",h="interface_method",Df="WL.Internal.jsonp.",ve=2000,af="body",kh="json_body",u="callback",oc="code",Og="Content-Type",gb="element",We="error",Li="error_description",zb="file_name",lh="file_input",Mi="file_output",cg="request_headers",Yf="response_headers",Oi="Location",He="logging",fc="message",hb="method",N="overwrite",Pd="rename",D="path",Fi="percentageComplete",Ui="Prefer",Mh="pretty",Ii="respond-async",Nh="result",Vi="status",Qg="http_status",Pg="return_ssl_resources",Ki="stream_input",Si="tracing",Wi="error",Gi=202,Ji=201,Pi=200,Di=500,Qi="success",fe="suppress_redirects",Id="suppress_response_codes",R="x_http_live_library",Xe=0,Qc=1,e="access_token",ki="appstate",tc="authentication_token",s="client_id",zc="display",ti="code",m="error",G="error_description",pb="expires",mb="expires_in",oi="locale",B="redirect_uri",Db="response_type",w="request_ts",df="resource_id",g="scope",sf="session",hc="secure_cookie",Z="state",f="status",nc=[e,tc,g,mb,pb],H="connected",Rh="notConnected",W="unchecked",Mb="unknown",yc="expiring",bj="expired",Zi="live-sdk-upload",Ti="live-sdk-download",si="appId",fi="channelUrl",qf="wl_auth",ff="wl_upload",jf="page",kd="touch",wc="none",Se="none",ic="auth.login",bd="auth.logout",bb="auth.sessionChange",Nc="auth.statusChange",vf="wl.log",eb="access_denied",wg="connection_failed",th="invalid_cookie",Rg="invalid_request",Eb="request_canceled",M="request_failed",pc="timed_out",Ri="unknown_user",Ni="user_canceled",mg="METHOD: Failed to get the required user permission to perform this operation.",ng="The request could not be completed due to browser issues.",Wd="The request could not be completed due to browser limitations.",gc="METHOD: The operation has been canceled.",Sd="The 'wl_auth' cookie is not valid.",Kd="The 'wl_auth' cookie has been modified incorrectly. Ensure that the redirect URI only modifies sub-keys for values received from the OAuth endpoint.",Jf="The 'wl_auth' cookie has multiple values. Ensure that the redirect URI specifies a cookie domain and path when setting cookies.",Fg="METHOD: The input property 'PARAM' does not reference a valid DOM element.",ah="METHOD: An exception was received for EVENT. Detail: MESSAGE",Gg="METHOD: The WL object must be initialized with WL.init() prior to invoking this method.",ae="A connection to the server could not be established.",Ci="The user could not be identified.",Hg="METHOD: Failed to get upload_location of the resource.",xg="The pending login request has been canceled.",Nf="Logging out the user is not supported in current session because the user is logged in with a Microsoft account on this computer. To logout, the user may quit the app or log out from the computer.",Xd="METHOD: The input value for parameter/property 'PARAM' is not valid.",og="METHOD: The input parameter/property 'PARAM' must be included.",Qf="METHOD: The type of the provided value for the input parameter/property 'PARAM' is not valid.",Dc="METHOD: There is a pending METHOD request, the current call will be ignored.",Hf=Dc.replace(/METHOD/g,O),Af=Dc.replace(/METHOD/g,Bb),zi=Dc.replace(/METHOD/g,Oe),Of="METHOD: The input property 'redirect_uri' is required if the value of the 'response_type' property is 'code'.",yi="WL.init: The redirect_uri value should be the same as the value of 'Redirect Domain' of your registered app. It must begin with 'http://' or 'https://'.",Ai="METHOD: The api call is not supported on this platform.",wi="WL.init: The response_type value 'code' is not supported on this platform.",vh="METHOD: The input property 'redirect_uri' must use https: to match the scheme of the current page.",pg="The auth request is timed out.",Ig="The popup is closed without receiving consent.",cd=0,hg=1,Yd=2,xh=3,kc="GET",dd="POST",Wh="PUT",Ah="DELETE",Xi="COPY",Yi="MOVE",Bb="WL.fileDialog",qc="WL.api",xb="WL.download",lc="WL.init",O="WL.login",uc="WL.ui",Oe="WL.upload",Ag=30000,p="METHOD",Ob="PARAM",q="onSuccess",r="onError",K="onProgress",vc="redirect_type",Fe="auth",re="upload",Bh="code",yb="token",xc="https:",rd="http:",lf="wl.signin",ci="wl.skydrive",Xg="wl.skydrive_update",Jh=/\s|,/,nb="boolean",Ac="dom",d="function",rf="number",ob="object",mc="properties",b="string",ec="string_or_array",kb="undefined",hi="name",ib="element",rc="brand",od="type",ac="sign_in_text",Xb="sign_out_text",y="theme",Ae="onloggedin",te="onloggedout",Fb="onerror",Ch="messenger",Qh="hotmail",Kh="skydrive",ed="windows",se="windowslive",nd="none",vd="signin",Sc=vd,ue="login",ke="connect",oe="custom",vb="blue",ub="white",Ze="id",lb="auth_server",U="apiservice_uri",V="skydrive_uri",I="sdk_root",Bc="wl_trace";window.WL={getSession:function(){try{return a.getSession()}catch(b){n(b.message)}},getLoginStatus:function(){try{return a.getLoginStatus({callback:De(arguments,d,2),internal:false},De(arguments,nb,2))}catch(e){return L("WL.getLoginStatus",e)}},logout:function(b){try{sc(b,Q,"WL.logout");return a.logout({callback:b})}catch(c){return L("WL.logout",c)}},canLogout:function(){return a.canLogout()},api:function(){try{var c=Vg(arguments);j(c,[{name:D,type:b,optional:false},{name:hb,type:b,optional:true},Q],qc);return a.api(c)}catch(f){return L(qc,f)}}};var ef=[ic,bd,bb,Nc,vf];WL.Event={subscribe:function(d,a){try{sc([d,a],[{name:"event",type:b,allowedValues:ef,caseSensitive:true,optional:false},eg],"WL.Event.subscribe");c.subscribe(d,a)}catch(e){n(e.message)}},unsubscribe:function(d,a){try{sc([d,a],[{name:"event",type:b,allowedValues:ef,caseSensitive:true,optional:false},Q],"WL.Event.unsubscribe");c.unsubscribe(d,a)}catch(e){n(e.message)}}};WL.Internal={};var c={subscribe:function(a,b){k("Subscribe "+a);var d=c.getHandlers(a);d.push(b)},unsubscribe:function(d,f){k("Unsubscribe "+d);var b=c.getHandlers(d),e=[];if(f!=null){var g=false;for(var a=0;a<b.length;a++)if(g||b[a]!=f)e.push(b[a]);else g=true}c._eHandlers[d]=e},getHandlers:function(b){if(!c._eHandlers)c._eHandlers={};var a=c._eHandlers[b];if(a==null)c._eHandlers[b]=a=[];return a},notify:function(d,e){k("Notify "+d);var b=c.getHandlers(d);for(var a=0;a<b.length;a++)b[a](e)}},a={_status:Xe,_statusRequests:[],_rpsAuth:false};a.appInit=function(b){var e=b[h]||lc;if(a._status==Qc){var f=a._session.getNormalStatus();return db(e,true,b.callback,f)}var c=WL[I];if(c){if(c.charAt(c.length-1)!=="/")c+="/";a[I]=c}var d=b[He];if(d===false)a._logEnabled=d;if(a.testInit)a.testInit(b);a._status=Qc;return tg(b)};a.onloadInit=function(){Zh();bi()};function C(b){if(a._status===Xe)throw new Error(Gg.replace(p,b))}function ud(){return WL.Internal.tApp||a}a.api=function(a){C(qc);var c=a[af];if(c){a=t(id(c),a);delete a[af]}var b=a[hb];a[hb]=(b!=null?Y(b):kc).toUpperCase();return (new tf(a)).execute()};var ch=function(){var b=a.api.lastId,c;b=b===undefined?1:b+1;c="WLAPI_REQ_"+b+"_"+(new Date).getTime();a.api.lastId=b;return c},tf=function(b){var c=this;c._properties=b;c._completed=false;c._id=ch();b[Mh]=false;b[Pg]=a._isHttps;b[R]=a[R];var d=b[D];c._url=ld(d)?d:Te()+(d[0]==="/"?d.substring(1):d);c._promise=new o(qc,null,null)};tf.prototype={execute:function(){Gh(this);return this._promise},onCompleted:function(a){if(this._completed)return;this._completed=true;F(this._properties.callback,a,true);if(a[m])this._promise[r](a);else this._promise[q](a)}};function ad(f,c,b,e,d){b=b?Y(b):"";var a=b!==""?fd(b):null;if(a===null){a={};if(Math.floor(c/100)!==2)a[We]=Dh(c,e)}if(d)d.forEach(function(b){a[b.name]=b.value});a[Qg]=c;f.onCompleted(a)}function Dh(c,b){var a={};a[oc]=M;a[fc]=b||ae;return a}function Tc(){var c=null;if(!a._rpsAuth){var b=ud()._session.getStatus();if(b.status===yc||b.status===H)c=b.session[e]}return c}function id(i){var c={};for(var b in i){var a=i[b],j=typeof a;if(a instanceof Array)for(var d=0;d<a.length;d++){var f=a[d],l=typeof f;if(j==ob&&!(a instanceof Date)){var h=id(f);for(var e in h)c[b+"."+d+"."+e]=h[e]}else c[b+"."+d]=f}else if(j==ob&&!(a instanceof Date)){var k=id(a);for(var g in k)c[b+"."+g]=k[g]}else c[b]=a}return c}function hh(c){if(!ri())return false;var b=Pe(c),a=new XMLHttpRequest;b.requestHeaders.forEach(function(b){a.setRequestHeader(b.name,b.value)});a.open(b.method,b.url,true);a.onreadystatechange=function(){if(a.readyState==4){var d=[];b.responseHeaders.forEach(function(b){d.push({name:b,value:a.getResponseHeader(b)})});ad(c,a.status,a.responseText,null,d)}};a.send(b.body);return true}function Pe(i){var a=Je(i._properties,null,[u,D,hb]),d=a[hb],g=a[cg]||[],k=a[Yf]||[],h=a[kh],f=wb(i._url,{"ts":(new Date).getTime()}),j=Tc(),c,b;a[fe]="true";a[Id]="true";if(j!=null)a[e]=j;if(d==kc||d==Ah){c=null;b=kc;f+="&"+A(a)}else{g.push({name:Og,value:"application/x-www-form-urlencoded"});c=h?JSON.stringify(h):A(a);b=dd}f+="&method="+d;return {url:f,method:b,requestHeaders:g,responseHeaders:k,body:c}}a.download=function(a){bg(a);C(xb);return (new Le(a)).execute()};function ge(b,f){var c=f||{},g=Te();if(!ld(b))b=g+(b.charAt(0)==="/"?b.substring(1):b);var d=Tc();if(d)c[e]=d;c[R]=a[R];return wb(b,c)}var Jd="notStarted",he="ready",Cc="downloadCompleted",Fd="downloadFailed",Rd="canceled",Zf="completed";function Le(a){this._properties=a;this._status=Jd}Le.prototype={execute:function(){this._promise=new o(xb,this,null);this._process();return this._promise},cancel:function(){this._status=Rd;if(this._cancel)try{this._cancel()}catch(a){}else{this._result=l(Eb,gc.replace(p,xb));this._process()}},downloadComplete:function(b,c){var a=this;a._result=c;a._status=b?Cc:Fd;a._process()},downloadProgress:function(a){this._promise[K](a)},_process:function(){switch(this._status){case Jd:this._start();break;case he:this._download();break;case Cc:case Fd:case Rd:this._complete()}},_start:function(){var b=this;a.getLoginStatus({internal:true,callback:function(){b._status=he;b._process()}})},_download:function(){var a=this;Uh(a)},_complete:function(){var a=this,c=a._result,d=a._status===Cc?q:r;a._status=Zf;var b=a._properties[u];if(b)b(c);a._promise[d](c)}};a.login=function(b,e,d){C(O);mh(b);if(!zh(e))return db(O,false,null,l(M,Hf));var c=a._session.tryGetResponse(b.normalizedScope);if(c!=null)return db(O,true,b.callback,c);a._pendingLogin=sh(b,Jg,d);return a._pendingLogin.execute()};function Jg(c,b){a._pendingLogin=null;var d=b[m];if(d)qb(O+": "+b[G]);else F(c.callback,b,true)}function xe(b){var a=b||"";if(a instanceof Array)a=a.join(" ");return Y(a)}a.getSession=function(){C("WL.getSession");return a._session.getStatus()[sf]};a.getLoginStatus=function(b,f){C("WL.getLoginStatus");b=b||{};if(!f){var d=a._session.tryGetResponse();if(d)return db("WL.getLoginStatus",true,b.callback,d)}k("wl_app:getLoginStatus");var e=a._statusRequests,c=null;if(!a._pendingStatusRequest){c=lg(b,jg);a._pendingStatusRequest=c}e.push(b);if(c!=null)c.execute();return a._pendingStatusRequest._promise};function jg(h,b){var f=a._statusRequests;a._pendingStatusRequest=null;k("wl_app:onGetLoginStatusCompleted");var d=b[m],e=false;while(f.length>0){var c=f.shift(),g=t(b);if(!d||c.internal)F(c.callback,g,true);if(!c.internal)e=true}if(d)if(e&&d!==pc)qb("WL.getLoginStatus: "+b[G]);else k("wl_app-onGetLoginStatusCompleted: "+b[G])}a.logout=function(f){var b="WL.logout";C(b);var d=new o(b,null,null),c=function(c){Kb(function(){var e,g=q;if(c){n(c.message);g=r;e=Vb(b,b,c)}else e=a._session.getNormalStatus();F(f.callback,e,false);d[g](e)})},e=function(){var b=a._session;if(b.isSignedIn())if(a.canLogout()){b.updateStatus(Mb);Hh(c)}else c(new Error(Nf));else c()};if(a._pendingStatusRequest!=null)a.getLoginStatus({internal:true,callback:e},false);else e();return d};a.upload=function(a){var c=a[h];C(c);j(a,[{name:D,type:b,optional:false},Q],c);Kf(a);Bg(a);return (new gd(a)).execute()};function Bg(a){var b=a[lh],c=a[zb];if(b)a[zb]=c||b.name}function Rf(a,h,i){var c=a.indexOf("?"),e=c!==-1,g="";if(e){g=a.substring(c+1);a=a.substring(0,c)}var f=typeof h!==kb,j=a.charAt(a.length-1)==="/";if(f&&!j)a+="/";var b=a,d={};if(f)b+=encodeURIComponent(h);if(i===Pd)d[N]="choosenewname";else d[N]=i;if(e)b=Ie(b,g);return Lc(b,d)}function ni(a){return /^(file|\/file)/.test(a.toLowerCase())}function Lc(b,a){a=a||{};a[Id]="true";return ge(b,a)}function Kf(a){if(N in a){var c=a[h],d=a[N],f=typeof d,i=f===nb,e=f===b;if(!(i||e))throw T(N,c);if(e){var g=/^(true|false|rename)$/i.test(d);if(!g)throw cb(N,c)}}else a[N]=false}var Ud=0,Zd=1,Ic=2,Fc=3,Tb=4,de=5,sg=6;function gd(a){this._props=a;this._status=Ud}gd.prototype={execute:function(){var a=this;a._strategy=a._getStrategy(a._props);a._promise=new o(a._props[h],a,null);a._process();return a._promise},cancel:function(){var a=this;a._status=de;if(a._cancel)try{a._cancel()}catch(c){}else{var b=gc.replace(p,a._props[h]);a._result=l(Eb,b);a._process()}},uploadProgress:function(a){this._promise[K](a)},uploadComplete:function(b,c){var a=this;a._result=c;a._status=b?Fc:Tb;a._process()},onErr:function(c){var a=this._props[h]+":"+c,b=l(M,a);this.uploadComplete(false,b)},onResp:function(a){a=a?Y(a):"";var b=a!==""?fd(a):null;b=b||{};this.uploadComplete(b.error==null,b)},setFileName:function(a){this._props[zb]=a},_process:function(){switch(this._status){case Ud:this._start();break;case Zd:this._getUploadPath();break;case Ic:this._upload();break;case Fc:case Tb:case de:this._complete()}},_start:function(){var a=this;ud().getLoginStatus({internal:true,callback:function(){a._status=Zd;a._process()}})},_getUploadPath:function(){var a=this,c=a._props,b=c[D];if(ld(b)){a._uploadPath=Lc(b);a._status=Ic;a._process();return}ud().api({path:b}).then(function(i){var d=i.upload_location;if(d){var e=Ph(b);d=Ie(d,e);var f=c[zb],g=c[N];if(ni(b))a._uploadPath=Lc(d);else a._uploadPath=Rf(d,f,g);a._status=Ic}else{a._result=l(M,Hg.replace(p,c[h]));a._status=Tb}a._process()},function(b){a._result=b;a._status=Tb;a._process()})},_upload:function(){this._strategy.upload(this._uploadPath)},_complete:function(){var a=this,c=a._result,d=a._status===Fc?q:r;a._status=sg;var b=a._props[u];if(b)b(c);a._promise[d](c)}};var gh=new RegExp("^\\w+\\.\\w+:\\w+[\\|\\w+]+:([\\d\\w]+\\!\\d+)$");function Y(a){return a.replace(/^\s+|\s+$/g,"")}function Td(a,b){return a&&b?a.toLowerCase()===b.toLowerCase():a===b}function ze(a){return a==null||a===""}function pd(){var a=arguments,c=a[0];function b(b){return a[parseInt(b.replace(/[\{\}]/g,""))+1]||""}return c.replace(/\{\d+\}/g,b)}function td(b){var a={c:0,s:-1};return b.replace(/[^\w .,-]/g,function(d,b,c){if(wh(c,b,a))return ["&#",a.c,";"].join("");return ""})}function wh(f,b,a){var d=a.s===b;if(!d){b=b||0;var c=f.charCodeAt(b),g,e;a.s=-1;if(c<55296||c>57343)a.c=c;else if(c<=56319){g=c;e=f.charCodeAt(b+1);a.c=(g-55296)*1024+(e-56320)+65536;a.s=b+1}else{a.c=-1;d=true}}return !d}function t(b,d){var c=d||{};if(b!=null)for(var a in b)c[a]=b[a];return c}function Je(e,d,b){var c=t(e,d);for(var a=0;a<b.length;a++)delete c[b[a]];return c}function ei(b,c){var a;for(a=0;a<b.length;a++)if(b[a]===c)return true;return false}function uf(a){return Array.prototype.slice.call(a)}function i(b,a){return function(){if(typeof a===d)return a.apply(b,arguments)}}function xf(a,g,d){d=d||"[WL]";a=d+a;var c=window;if(c.debugLogger)c.debugLogger.push(a);var b=c.console;if(b&&b.log)switch(g){case "warning":b.warn(a);break;case "error":b.error(a);break;default:b.log(a)}var f=c.opera;if(f)f.postError(a);var e=c.debugService;if(e)e.trace(a)}function ld(a){return a.indexOf("https://")===0||a.indexOf("http://")===0}function k(b){if(a._traceEnabled)xf(b)}function qb(b,e,d){if(a._logEnabled||a._traceEnabled)xf(b,e,d);c.notify(vf,b)}if(window.WL&&WL.Internal){WL.Internal.trace=k;WL.Internal.log=qb}function vi(b,a){qb(b,"text",a)}function n(b,a){qb(b,"error",a)}function Ce(b,c){var a=bc("iframe");a.id=c;a.src=b;document.body.appendChild(a);return a}function bc(b){var a=document.createElement(b);a.style.position="absolute";a.style.top="-1000px";a.style.width="300px";a.style.height="300px";a.style.visibility="hidden";return a}function Rc(){var a=null;while(a==null){a="wl_"+Math.floor(Math.random()*1024*1024);if(jb(a)!=null)a=null}return a}function jb(a){return document.getElementById(a)}function di(a,b){if(a)if(a.innerText)a.innerText=b;else{var c=document.createTextNode(b);a.innerHTML="";a.appendChild(c)}}function Ph(b){var a=b.indexOf("?");if(a===-1)return "";var c=b.indexOf("#",a+1);if(c!==-1)return b.substring(a+1,c);return b.substring(a+1)}function Ie(a,b){if(typeof b===kb||b===null||b==="")return a;var c=a.indexOf("?");if(c===-1)return a+"?"+b;if(a.charAt(a.length-1)!=="&")a+="&";return a+b}function yf(a){t(xd(a),this)}yf.prototype={toString:function(){var a=this,b=(a.scheme!=""?a.scheme+"//":"")+a.host+(a.port!=""?":"+a.port:"")+a.path;return b},resolve:function(){var a=this;if(a.scheme==""){var b=window.location.port,c=window.location.host;a.scheme=window.location.protocol;a.host=c.split(":")[0];a.port=b!=null?b:"";if(a.path.charAt(0)!="/")a.path=oh(a.host,window.location.href,a.path)}}};function xd(c){var e=c.indexOf(xc)==0?xc:c.indexOf(rd)==0?rd:"",h="",i="",f;if(e!="")var b=c.substring(e.length+2),a=b.indexOf("/"),g=a>0?b.substring(0,a):b,d=g.split(":"),h=d[0],i=d.length>1?d[1]:"",f=a>0?b.substring(a):"";else f=c;return {scheme:e,host:h,port:i,path:f}}function gi(a){return xd(a.toLowerCase()).host}function oh(e,b,h){var d=function(a,c){charIdx=b.indexOf(c);a=charIdx>0?a.substring(0,charIdx):a;return a};b=d(d(b,"?"),"#");var f=b.indexOf(e),a=b.substring(f+e.length),g=a.indexOf("/"),c=a.lastIndexOf("/");a=c>=0?a.substring(g,c):a;return a+"/"+h}function ji(a){var b=a.indexOf("?");if(b>0)a=a.substring(0,b);b=a.indexOf("#");if(b>0)a=a.substring(0,b);return a}function tb(a,b){if(typeof a==d)b?a(b):a()}function F(a,b,e,c){if(typeof a==d){if(c)b[Z]=c;if(e)a(b);else Kb(function(){a(b)})}}function fd(a){return JSON.parse(a)}function Ne(){return Math.floor((new Date).getTime()/1000)}function ui(b,c){var d=b.length;for(var a=0;a<d;a++)c(b[a])}function Sh(c,b){var a={};a[m]=c;a[G]=b;return a}function l(d,c){var a={},b={};a[oc]=d,a[fc]=c;b[We]=a;return b}function Vb(a,b,c){return l(M,ah.replace("METHOD",a).replace("EVENT",b).replace("MESSAGE",c.message))}function Ng(b){var a=b.split(".");return a[0]+"."+a[1]}function Kb(a,b){window.wlUnitTests?wlUnitTests.delayInvoke(a):window.setTimeout(a,b||1)}function Zh(){var b=ai(navigator.userAgent,document.documentMode),c=a[R];a._browser=b;a[R]=c.replace("DEVICE",b.device)}function ai(a,e){a=a.toLowerCase();var c="other",b={"firefox":/firefox/.test(a),"firefox1.5":/firefox\/1\.5/.test(a),"firefox2":/firefox\/2/.test(a),"firefox3":/firefox\/3/.test(a),"firefox4":/firefox\/4/.test(a),"ie":(/msie/.test(a)||/trident/.test(a))&&!/opera/.test(a),"ie6":false,"ie7":false,"ie8":false,"ie9":false,"ie10":false,"ie11":false,"opera":/opera/.test(a),"webkit":/webkit/.test(a),"chrome":/chrome/.test(a),"mobile":/mobile/.test(a)||/phone/.test(a)};if(b["ie"]){var d=0;if(e)d=e;else if(/msie 7/.test(a))d=7;d=Math.min(11,Math.max(d,6));c="ie"+d;b[c]=true}else if(b.firefox)c="firefox";else if(b.chrome)c="chrome";else if(b.webkit)c="webkit";else if(b.opera)c="opera";if(b.mobile)c+="mobile";b.device=c;return b}function Yb(e,c){var f=c!=null?c:{};if(e!=null){var d=e.split("&");for(var b=0;b<d.length;b++){var a=d[b].split("=");if(a.length==2)f[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}}return f}function A(b){var a="";if(b!=null)for(var c in b){var d=a.length==0?"":"&",e=b[c];a+=d+encodeURIComponent(c)+"="+encodeURIComponent(ph(e))}return a}function ph(a){if(a instanceof Date){var b=function(a,b){switch(b){case 2:return a<10?"0"+a:a;case 3:return (a<10?"00":a<100?"0":"")+a}};return a.getUTCFullYear()+"-"+b(a.getUTCMonth()+1,2)+"-"+b(a.getUTCDate(),2)+"T"+b(a.getUTCHours(),2)+":"+b(a.getUTCMinutes(),2)+":"+b(a.getUTCSeconds(),2)+"."+b(a.getUTCMilliseconds(),3)+"Z"}return ""+a}function Ih(b){var d=b.indexOf("?")+1,c=b.indexOf("#")+1,a={};if(d>0){var e=c>d?c-1:b.length;a=Yb(b.substring(d,e),a)}if(c>0)a=Yb(b.substring(c),a);return a}function wb(a,b){return a+(a.indexOf("?")<0?"?":"&")+A(b)}function Wg(a){switch(typeof a){case nb:return a;case rf:return !!a;case b:return a.toLowerCase()==="true";default:return false}}var Q={name:u,type:d,optional:true},eg={name:u,type:d,optional:false};function sc(a,c,d){if(a instanceof Array)for(var b=0;b<a.length;b++)gf(a[b],c[b],d);else gf(a,c,d)}function gf(c,a,b){Qe(c,a,b);if(a.type===mc)j(c,a.properties,b)}function Qe(g,f,c,h){var e=f.name,a=typeof g,i=f.type;if(a===kb||g==null)if(f.optional){h&&h();return}else throw Mc(e,c);switch(i){case b:if(a!=b)throw T(e,c);if(!f.optional&&Y(g)==="")throw Mc(e,c);break;case mc:if(a!=ob)throw T(e,c);break;case d:if(a!=d)throw T(a,c);break;case Ac:if(a==b){if(jb(g)==null)throw new Error(Fg.replace(p,c).replace(Ob,e))}else if(a!=ob)throw T(e,c);break;case ec:if(a!=b&&!(g instanceof Array))throw T(a,c);break;default:if(a!=i)throw T(e,c)}if(f.allowedValues!=null)ih(g,f.allowedValues,f.caseSensitive,e,c)}function j(g,d,f){var b=g||{};for(var c=0;c<d.length;c++){var a=d[c],e=b[a.name]||b[a.altName];Qe(e,a,f,function(){if(typeof a.defaultValue!=kb)b[a.name]=a.defaultValue})}}function ih(d,a,e,f,h){var g=typeof a[0]===b;for(var c=0;c<a.length;c++)if(g&&!e){if(d.toLowerCase()===a[c].toLowerCase())return}else if(d===a[c])return;throw cb(f,h)}function T(a,b){return new Error(Qf.replace(p,b).replace(Ob,a))}function Mc(a,b){return new Error(og.replace(p,b).replace(Ob,a))}function cb(c,d,a){var b=Xd.replace(p,d).replace(Ob,c);if(typeof a!==kb)b+=" "+a;return new Error(b)}function De(b,d,c){if(b)for(var a=0;a<c&&a<b.length;a++)if(d===typeof b[a])return b[a];return undefined}function fb(j,i){var f=uf(j),a=null,b=null;for(var e=0;e<f.length;e++){var c=f[e],g=typeof c;if(g===ob&&a===null)a=t(c);else if(g===d&&b===null)b=c}a=a||{};if(b)a.callback=b;a[h]=i;return a}function Vg(e){var a=uf(e),d=null,c=null;if(typeof a[0]===b){d=a.shift();if(typeof a[0]===b)c=a.shift()}normalizedArgs=fb(a);if(d!==null){normalizedArgs[D]=d;if(c!=null)normalizedArgs[hb]=c}return normalizedArgs}function L(a,b){var c=Vb(a,a,b);n(b.message);return db(a,false,null,c)}var o=function(b,c,a){this._name=b;this._op=c;this._uplinkPromise=a;this._isCompleted=false;this._listeners=[]};o.prototype={then:function(d,e,c){var b=new o(null,null,this),a={};a[q]=d;a[r]=e;a[K]=c;a.chainedPromise=b;this._listeners.push(a);return b},cancel:function(){if(this._isCompleted)return;if(this._uplinkPromise&&!this._uplinkPromise._isCompleted)this._uplinkPromise.cancel();else{var a=this._op?this._op.cancel:null;if(typeof a===d)this._op.cancel();else this.onError(l(Eb,gc.replace("METHOD",this._getName())))}},_getName:function(){if(this._name)return this._name;if(this._op&&typeof this._op._getName===d)return this._op._getName();if(this._uplinkPromise)return this._uplinkPromise._getName();return ""},_onEvent:function(b,a){if(this._isCompleted)return;this._isCompleted=a!==K;this._notify(b,a)},_notify:function(b,a){var c=this;ui(this._listeners,function(g){var h=g[a],d=g.chainedPromise,f=a!==K;if(h)try{var e=h.apply(g,b);if(f&&e&&e.then){d._op=e;e.then(function(a){d[q](a)},function(a){d[r](a)},function(a){d[K](a)})}}catch(i){if(f)d.onError(Vb(c._getName(),a,i))}else if(f)d[a].apply(d,b)})}};o.prototype[q]=function(){this._onEvent(arguments,q)};o.prototype[r]=function(){this._onEvent(arguments,r)};o.prototype[K]=function(){this._onEvent(arguments,K)};function db(f,e,b,g){var a=new o(f,null,null),c=e?q:r;if(typeof b===d)a.then(function(a){b(a)});Kb(function(){a[c](g)});return a}var nc=[e,tc,g,mb,pb,w,m,G],Ve="refresh_type",jh="app",Xc="ms",Yc="response_method",ee="url",Qd="cookie",dc="onanalytics",Be="login",Vd="loginstatus",ug="file_dialog",cc="auth.response",Ke="client-id",Bi="OneDriveSaveButton",wd="file",jc="click",sd="onedrive-js",je="2px",Nd="0px",we="4px",Tf="METHOD: Failed to initialize due to missing 'client-id'.",dg="Loading OneDrive picker is timed out.",x="mode",P="open",Hc="save",sb="read",rb="readwrite",Jc="linkType",Hd="resourceType",Rb="file",Qb="folder",S="select",ab="single",Gc="multi",Wf="permission",Ef="onetime",Ub="lightbox",Pf="grey",yd="transparent",Ec="white",Cd="loading_timeout",Md="onselected",Zb="cancel",pe="error",ye="file",be="fileName",Cg="internal_app",Pc=Jc,Dd="downloadLink",Sb="webViewLink",ce="progress",me="multiSelect",Wb="success",qe="theme",Kc="blue",ag="white",xi=p+": This upload method is not implemented.",uh="{0}: Operation: '{1}' Error message: {2}",Hi="API call",Ld="invoke picker",Pb="unhandled exception",Uf="upload",Tg="OneDrive.open",Ug="OneDrive.save",Ad="OneDrive.createOpenButton",Gf="OneDrive.createSaveButton",Sg="auth",fg="rps",Vf="oauth",gg="v",Bf="1",Cf="2",yg="domain",qg="livesdk",bh="mkt";FILEDIALOG_PARAM_PICKER_SCRIPT="pickerscript";FILEDIALOG_CHCMD_ONCOMPLETE="onPickerComplete",FILEDIALOG_CHCMD_UPDATETOKEN="updateToken";var mi=27;UI_SKYDRIVEPICKER="skydrivepicker",ONEDRIVE_PREFIX="[OneDrive]";WL.init=function(e){try{var c=t(e),d=lc;sc(c,{name:mc,type:mc,optional:false,properties:[{name:s,altName:si,type:b,optional:false},{name:g,type:ec,optional:true},{name:B,altName:fi,type:b,optional:true},{name:Db,type:b,allowedValues:[Bh,yb],optional:true},{name:Ve,type:b,allowedValues:[jh,Xc],optional:true},{name:He,type:nb,optional:true},{name:f,type:nb,optional:true}]},d);if(!c[B]&&c[Db]===ti)throw new Error(Of.replace(p,d));if(c[f]==null)c[f]=true;return a.appInit(c)}catch(h){return L(d,h)}};WL.login=function(){try{var d=fb(arguments),c=O;j(d,[{name:g,type:ec,optional:true},{name:B,type:b,optional:true},{name:Z,type:b,optional:true},Q],c);return a.login(d)}catch(h){return L(c,h)}};WL.download=function(){try{var b=xb,c=fb(arguments,b);return a.download(c)}catch(f){return L(b,f)}};WL.upload=function(){try{var b=Oe,c=fb(arguments,b);return a.upload(c)}catch(f){return L(b,f)}};WL.ui=function(){try{var c=fb(arguments);j(c,[{name:hi,type:b,allowedValues:[vd,UI_SKYDRIVEPICKER],optional:false},Q],uc);a.ui(c)}catch(f){ie(c,f)}};WL.fileDialog=function(){try{var b=Bb,c=fb(arguments,b);le(c,b);return a.fileDialog(c)}catch(f){return L(b,f)}};function le(e,c){j(e,[{name:x,type:b,allowedValues:[P,Hc,sb,rb],optional:false},{name:Hd,type:b,allowedValues:[Rb,Qb],optional:true},{name:S,type:b,allowedValues:[ab,Gc],optional:true},{name:Ub,type:b,allowedValues:[Pf,yd,Ec],optional:true},{name:Cd,type:rf,optional:true},{name:Wf,type:b,allowedValues:[Ef],optional:true},Q],c);if(c!==Bb)j(e,[{name:y,allowedValues:[vb,ub],type:b,optional:true},{name:Md,type:d,optional:false},{name:Fb,type:d,optional:true}],c);if(!hd.isSupported()||!window.JSON||a._browser.mobile)throw new Error(Wd)}function fh(){a._urlParams=Ih(window.location.href);a._pageState=Yb(a._urlParams[Z])}function Ge(){var b=new Jb(qf);b.load();var c=a._urlParams,d=a._pageState,i=true,l=d[w];if(l)if(l!=b.get(w))b.set(w,d[w]);else i=false;var j=c[e]!=null,n=b.get(e)!=null||j,o=n?H:Mb,p=Ne();if(d[Yc]===ee){for(var h=0;h<nc.length;h++){var g=nc[h];if(c[g])b.set(g,c[g])}if(j){b.set(pb,p+parseInt(c[mb]));b.remove(m);b.remove(G)}else if(!n)if(c[m]===eb)o=Rh}else if(i){var k=vg(b);if(k){b.set(m,th);b.set(G,k)}}else return;b.set(f,o);b.save()}function Oh(){var b=a._pageState,f=b[vc];if(f===re){var i=b[Ze],h=a._urlParams[Nh];dh(i,h);return}var c=b[zc],g=b[hc]==="true";a._logEnabled=true;a._traceEnabled=b[Bc]||a._urlParams[Bc];a._secureCookie=g;Eg();if(c===jf||c===kd){Ge();if(c===kd&&a._browser.ie)document.location=b[B];else window.close()}else if(c===wc)Ge();else{Ab(Xh);var e=window.wlAsyncInit;if(e&&typeof e===d)e.call()}}function eh(a,b){if(!a)a=ji(window.location.href);return Ff(a,window.location.hostname,b)}function Ff(f,e,d){var b=new yf(f);b.resolve();var e=e.split(":")[0].toLowerCase(),c=b.host.toLowerCase();a._domain=a._domain||c;if(a._isHttps&&b.scheme==rd)throw new Error(vh.replace("METHOD",d));return b.toString()}function vg(a){var i=a.get(e)!=null,f=a.get(m)!=null,h=a.get(g)!=null,c=a.get(mb)!=null,d=a.get(s)!=null,b=null;if(!(i&&h&&c)&&!f){n(Sd);b=Sd}if(!d){n(Kd);b=Kd}return b}function bi(){ve=a._browser.ie?2000:4000;fh();Oh()}function dh(c,b){var a=new Jb(ff);a.load();a.set(c,b);a.save()}function tg(b){a._authScope=xe(b[g]);a._secureCookie=Wg(b[hc]);a._redirect_uri=eh(b[B],lc);a._response_type=(b[Db]||yb).toLowerCase();a._appId=b[s];a._refreshType=(b[Ve]||Xc).toLowerCase();var i=new nf(b[s],qf);a._session=i;var d=i.getNormalStatus(),j=d[f],e,h=lc;if(j==H){c.notify(bb,d);c.notify(Nc,d);c.notify(ic,d);e=db(h,true,b.callback,d)}else if(b[f]){e=new o(h,null,null);a.getLoginStatus({internal:true,callback:function(a){var b=!!a.error?r:q;e[b](a)}},true)}return e}function zh(){var b=a._pendingLogin;if(b!=null){b.cancel();a._pendingLogin=null}return true}function mh(c){var b=xe(c[g]);if(b==="")b=a._authScope;if(!b||b==="")throw Mc(g,O);c.normalizedScope=b}function sh(c,b,a){return new qd(Be,c,b,a)}function lg(b,a){return new qd(Vd,b,a)}a.ensurePermission=function(d,e,f,b){var c=l(eb,mg.replace("METHOD",f));a.login({scope:d}).then(function(f){if(f.session[mb]<e)a.getLoginStatus({internal:true},true).then(function(){a.login({scope:d}).then(function(a){b(a)},function(){b(c)})},function(){b(c)});else b(f)},function(){b(c)})};a.canLogout=function(){return true};function Hh(d){Re();var b=bc("iframe"),c=Me(),e="/oauth20_logout.srf?ts=";b.src="//"+c+e+(new Date).getTime();document.body.appendChild(b);a.logoutFrame=b;window.setTimeout(function(){Re();d()},30000)}function Re(){if(a.logoutFrame!=null){document.body.removeChild(a.logoutFrame);a.logoutFrame=null}}function ie(c,b){n(b.message);var a=c[Fb];if(a)Kb(function(){error=Vb(uc,uc,b),a(error)})}function bf(){return a[I]}function kf(){return bf()+"images"}var md=function(c){var a=this;a._properties=c;var b=i(a,a.init);Ab(b)};md.prototype={init:function(){var d=this,e=d._properties;if(d._inited===true)return;d._inited=true;try{d.validate();var f=e[ib],g=e[od],m=e[u],j=e[ac],h=e[Xb];Xf(e);f=typeof f===b?jb(e[ib]):f;d._element=f;g=g!=null?g:Sc;if(g==Sc){j=z.signIn;h=z.signOut}else if(g==ue){j=z.login;h=z.logout}else if(g==ke){j=z.connect;h=z.signOut}d[ac]=j;d[Xb]=h;mf(f,Dg(e));var k=a._session.isSignedIn(),l=k?h:j;d.updateUI(l,k);Lf(d,f.childNodes[0]);c.subscribe(ic,i(d,d.onLoggedIn));c.subscribe(bd,i(d,d.onLoggedOut));a.getLoginStatus({internal:true});delete e[u];F(m,e,false)}catch(n){ie(e,n)}},validate:function(){var a=this._properties;j(a,[{name:ib,type:Ac,optional:false},{name:od,allowedValues:[Sc,ue,ke,oe],type:b,optional:true},{name:g,type:ec,optional:true},{name:Z,type:b,optional:true},{name:Ae,type:d,optional:true},{name:te,type:d,optional:true},{name:Fb,type:d,optional:true}],"WL.ui-signin");zf(a);var c=a[od];if(c==oe)j(a,[{name:ac,type:b,optional:false},{name:Xb,type:b,optional:false}],"WL.ui-signin")},fireEvent:function(b,c){var a=this._properties[b];if(a)a(c)},onClick:function(){var b=this;if(b._element.childNodes.length==0){Gd(b);return false}if(a._session.isSignedIn()){if(a.canLogout())a.logout({})}else a.login(b._properties,true).then(function(){},function(a){b.fireEvent(Fb,a)});return false},onLoggedIn:function(a){this.updateUI(this[Xb],true);this.fireEvent(Ae,a)},onLoggedOut:function(a){this.updateUI(this[ac],false);this.fireEvent(te,a)}};function Xf(b){if(a._authScope&&a._authScope!=="")b[g]=a._authScope;if(!b[g])b[g]=lf}function If(d,a,c){a._handlers=a._handlers||{};var b=i(a,c);a._handlers[d]=b;return b}function Sf(b,a){return a._handlers[b]}a.ui=function(a){C(uc);switch(a.name){case vd:new md(a);break;case UI_SKYDRIVEPICKER:new ne(a)}};function zf(a){j(a,[{name:y,allowedValues:[vb,ub],type:b,optional:true},{name:rc,allowedValues:[Ch,Qh,Kh,ed,se,nd],type:b,optional:true}],"WL.ui-signin");a[y]=a[y]||vb;a[rc]=a[rc]||ed}function Dg(f){var d=f[rc],e=f[y],g=a._locale,b=g.indexOf("ar")>-1||g.indexOf("he")>-1?"RTL":"LTR",h="cursor:pointer;background-color:transparent;border:solid 0px;display:inline-block;overflow:hidden;white-space:nowrap;padding:0px;width:auto;",c="margin:0px;padding:0px;border-width:0px;vertical-align:middle;background-attachment:scroll;display:inline-block;white-space:nowrap;",k=Wc(d,b,e,"left")+c,i=Wc(d,b,e,"center")+c,j=Wc(d,b,e,"right")+c;return '<button style="'+h+'"><span style="'+k+'"></span><span style="'+i+'"><span style="'+ig(b)+'"></span></span><span style="'+j+'"></span></button>'}function ig(g){var b=a._browser,j=b.ie6||b.ie7,k=b.ie8||b.ie9,f=b.chrome||b.safari?"padding:2px 3px;margin:0px;":"padding:1px 3px;margin:0px;",h="font-family: Segoe UI, Verdana, Tahoma, Helvetica, Arial, sans-serif;",e="direction:"+g.toLowerCase()+";",d="text-decoration:none;color:#3975a0;display:inline-block;",c="150";switch(a._locale){case "ar-ploc-sa":if(!j)c="170";break;case "te":case "ja-ploc-jp":if(b.ie)c="190"}var i="height:18px;font-size:9pt;font-weight:bold;line-height:"+c+"%;";return f+e+d+h+i}function Wc(a,b,i,g){a=a==ed?se:a;var h=a+"_"+b+"_"+i,e,d,c,f="background: url({imgpath}/signincontrol/{image}.png) scroll {repeat} 0px {vpos}; height: 22px; width: {width};";switch(g){case "left":e=a===nd||b==="RTL"?"3px":"25px";d=b==="LTR"?"0px":"-44px";c="no-repeat";break;case "center":e="auto";d="-22px";c="repeat-x";break;case "right":e=a===nd||b==="LTR"?"3px":"25px";d=b==="LTR"?"-44px":"0px";c="no-repeat"}return f.replace("{imgpath}",kf()).replace("{image}",h).replace("{vpos}",d).replace("{width}",e).replace("{repeat}",c)}md.prototype.updateUI=function(d){if(this._element.childNodes.length==0){Gd(this);return}if(d!=this._text){var c=a._browser,b=this._element.childNodes[0],e=b.childNodes[1];di(e.childNodes[0],d);this._text=d;if(c.ie6||c.ie7){e.style.width="auto";b.style.width="auto";var h=b.childNodes[0].clientWidth,f=b.childNodes[1].clientWidth,g=b.childNodes[2].clientWidth,i=h+f+g;b.style.width=i+"px";if(c.ie6){b.childNodes[0].style.width=h+"px";b.childNodes[1].style.width=f+"px";b.childNodes[2].style.width=g+"px"}}}};function Lf(a,b){a._button=b;v(b,"click",If("click",a,a.onClick))}function Gd(a){var b=a._button;if(b){E(b,"click",Sf("click",a));delete a._button}}var ne=function(b){le(b);var a=this;a._props=b;Ab(i(a,a.init))};ne.prototype={init:function(){var a=this;if(a._inited===true)return;a._inited=true;try{var c=a._props,d=c[ib],e=c[u];c[h]="WL.ui-"+UI_SKYDRIVEPICKER;a.validate();c[y]=c[y]||ub;d=typeof d===b?jb(c[ib]):d;a._element=d;var f=Mf(c);mf(d,f);kg(d,i(a,a.onClick),i(a,a.onRender));a.onRender(false,false);F(e,c,false)}catch(g){n(g.message)}},validate:function(){var a=this._props;j(a,[{name:ib,type:Ac,optional:false}],a[h])},onClick:function(){try{return a.fileDialog(this._props)}catch(b){n(b.message)}return false},onRender:function(){Ed(this._props,this._element.childNodes[0])}};function Ed(k,e){var h=k[y]===ub,j=a._locale,f=j.indexOf("ar")>-1||j.indexOf("he")>-1,l=f?"RTL":"LTR",n=e.childNodes[0],m=e.childNodes[1],d="#094AB2",i="#ffffff",b=e.style,g=n.style,c=m.style;b.direction=l;b.backgroundColor=h?i:d;b.border="solid 1px";b.borderColor=d;b.height="20px";b.paddingLeft=we;b.paddingRight=we;b.textAlign="center";b.cursor="pointer";g.verticalAlign="middle";g.height="16px";c.fontFamily="'Segoe UI', 'Segoe UI Web Regular', 'Helvetica Neue', 'BBAlpha Sans', 'S60 Sans', Arial, 'sans-serif'";c.fontSize="12px";c.fontWeight="bold";c.color=h?d:i;c.textAlign="center";c.verticalAlign="middle";c.marginLeft=f?Nd:je;c.marginRight=f?je:Nd}function Mf(b){var a=zd(b,false);return "<button id='"+td(a.buttonId)+"' title='"+td(a.buttonTitle)+"'>"+a.innerHTML+"</button>"}function zd(b,c){var m=b[x],l=b[y],a=m===P,e=a?z.skyDriveOpenPickerButtonText:z.skyDriveSavePickerButtonText,i=l===vb?"SkyDriveIcon_white.png":"SkyDriveIcon_blue.png",h="<img alt='' src='"+kf()+"/SkyDrivePicker/"+i+"'>",g="<span>"+td(e)+"</span>",d=a?z.skyDriveOpenPickerButtonTooltip:z.skyDriveSavePickerButtonTooltip,j=c?"onedriveopenpickerbutton":"skydriveopenpickerbutton",k=c?"onedrivesavepickerbutton":"skydrivesavepickerbutton",f=a?j:k;return {innerHTML:h+g,buttonTitle:d,buttonId:f}}function kg(c,l,k){var a=c.childNodes[0];if(l){var f=function(b){if(c.childNodes.length==0){E(a,jc,f);return}l(b)};v(a,jc,f)}if(k){var d=false,e=false,g=function(a){e=true;b(a)},h=function(a){e=false;b(a)},i=function(a){d=true;b(a)},j=function(a){d=false;b(a)},b=function(){if(c.childNodes.length==0){E(a,"mouseenter",g);E(a,"mouseleave",h);E(document,"mousedown",i);E(document,"mouseup",j);return}k(d,e)};v(a,"mouseenter",g);v(a,"mouseleave",h);v(document,"mousedown",i);v(document,"mouseup",j)}}function pi(c){var a=document.cookie;c+="=";var b=a.indexOf(c);if(b>=0){b+=c.length;var d=a.indexOf(";",b);if(d<0)d=a.length;else{postCookie=a.substring(d);if(postCookie.indexOf(c)>=0)throw new Error(Jf)}var e=a.substring(b,d);return e}return ""}function wf(g,d,f,e){d=d?d:"";var c=g+"="+d+"; path=/";if(f&&f!="localhost")c+="; domain="+encodeURIComponent(f);if(e!=null){var b=new Date(0);if(e>0){b=new Date;b.setTime(b.getTime()+e*1000)}c+=";expires="+b.toUTCString()}if(a._isHttps&&a._secureCookie)c+=";secure";document.cookie=c}var Jb=function(a,b){this._cookieName=a;this._states=b||{};this._listeners=[];this._cookieWatcher=null};Jb.prototype={getStates:function(){return this._states},get:function(a){return this._states[a]},set:function(b,a){this._states[b]=a},remove:function(a){if(this._states[a])delete this._states[a]},load:function(){try{var a=pi(this._cookieName);if(this._rawValue!=a){k("Cookie changed: "+this._cookieName+"="+a);this._rawValue=a;this._states=Yb(a);for(var b=0;b<this._listeners.length;b++)this._listeners[b]()}}catch(c){n(c.message);this.stopMonitor()}},flush:function(a){this._states=a;this.save()},populate:function(a){t(a,this._states);this.save()},save:function(){wf(this._cookieName,A(this._states),Ye(),null)},clear:function(){this._states={};wf(this._cookieName,"",Ye(),0)},addCookieChanged:function(a){this._listeners.push(a);this.startMonitor()},startMonitor:function(){this._refreshInterval=300;if(!this._cookieWatcher){k("Started monitoring cookie: "+this._cookieName);this._cookieWatcher=window.setInterval(i(this,this.load),this._refreshInterval)}},stopMonitor:function(){if(this._cookieWatcher){k("Stopped monitoring cookie: "+this._cookieName);window.clearInterval(this._cookieWatcher);this._cookieWatcher=null}},isBeingMonitored:function(){return this._cookieWatcher!==null}};function Ye(){var b=a._domain||window.location.hostname.split(":")[0];return b}var qd=function(d,b,c){var a=this;a._method=d;a._completed=false;a._requestFired=false;a._properties=b;a._callback=c;a._authMonitor=i(a,a._onAuthChanged);a.execute=a._method==Be?a._login:a._getLoginStatus};qd.prototype={cancel:function(){this._onComplete({error:Eb,error_description:xg})},_login:function(){var b=this;b._requestTs=(new Date).getTime();var e=a._browser.mobile,d=e&&a._browser.ie,g=e?kd:jf,f=hf(g,b._properties.normalizedScope,Zc(b._properties),b._requestTs,d,b._properties.state);if(d)document.location=f;else{b._popup=qi(f,b._properties.external_consent);k("AuthRequest-login: popup is opened. "+b._popup);b._popupWatcher=window.setInterval(i(b,b._checkPopup),3000);c.subscribe(cc,b._authMonitor)}b._promise=new o(O,null,null);return b._promise},_getLoginStatus:function(){nh(i(this,this._fireStatusRequest));this._timeout=window.setTimeout(i(this,this._onTimedOut),Ag);this._promise=new o("WL.getLoginStatus",null,null);return this._promise},_fireStatusRequest:function(){var b=this;if(!b._requestFired){b._requestTs=(new Date).getTime();var d=a._refreshType===Xc?hf(wc,a._authScope,Zc(),b._requestTs,false):rh(Zc(),a._authScope,b._requestTs);b._statusFrame=Ce(d);c.subscribe(cc,b._authMonitor);b._requestFired=true}},_onAuthChanged:function(){var b=a._session.tryGetResponse(this._properties.normalizedScope,this._requestTs,this._properties.external_consent);if(b!=null)this._onComplete(this._normalizeResp(b))},_normalizeResp:function(b){if(this._method===Vd&&b.error===eb)return a._session.getNormalStatus();return b},_onTimedOut:function(){this._onComplete({error:pc,error_description:pg})},_checkPopup:function(){try{if(this._popup===null)this._onComplete({error:eb,error_description:Ig});else if(this._popup.closed)this._popup=null}catch(a){k("AuthRequest-checkPopup-error: "+a)}},_onComplete:function(a){if(!this._completed){this._completed=true;this._dispose();this._callback(this._properties,a);if(a[m])this._promise[r](a);else this._promise[q](a)}},_dispose:function(){k("AuthRequest: dispose "+this._method);if(this._timeout){window.clearTimeout(this._timeout);this._timeout=null}if(this._statusFrame!=null){document.body.removeChild(this._statusFrame);this._statusFrame=null}if(this._popupWatcher){window.clearInterval(this._popupWatcher);this._popupWatcher=null}c.unsubscribe(cc,this._authMonitor)}};function qi(q,h){var c=525,b=525,e,d;if(h){c=800;b=650}if(a._browser.ie){var l=window.screenLeft,m=window.screenTop,f=document.documentElement,j=30;d=l+Math.max(f.clientWidth-c,0)/2;e=m+Math.max(f.clientHeight-b,0)/2-j}else{var o=window.screenX,p=window.screenY,k=window.outerWidth,i=window.outerHeight;d=o+Math.max(k-c,0)/2;e=p+Math.max(i-b,0)/2}var n=["width="+c,"height="+b,"top="+e,"left="+d,"status=no","resizable=yes","toolbar=no","menubar=no","scrollbars=yes"],g=window.open(q,"oauth",n.join(","));g.focus();return g}function rh(d,i,f){var b={};b[vc]=Fe;b[w]=f;b[hc]=a._secureCookie;b[zc]=wc;b[Yc]=Qd;if(a.trace)b[Bc]=true;var j=A(b),c={};c[s]=a._session.get(s);c[Db]=yb;c[g]=i;c[Z]=j;var h=d.indexOf("?")>0,e=h?"&":"?",k=d+e+A(c);return k}function hf(d,m,i,k,l,f){var b={};b[vc]=Fe;b[zc]=d;b[w]=k;if(l)b[B]=window.location.href;if(a.trace)b[Bc]=true;if(f)b[ki]=f;var e=d===wc?yb:a._response_type,h=e===yb?ee:Qd;b[Yc]=h;b[hc]=a._secureCookie;var n=A(b),c={};c[s]=a._session.get(s);c[zc]=d;c[oi]=a._locale;c[B]=i;c[Db]=e;c[g]=m;c[Z]=n;var j=Me(),o="https://"+j+"/oauth20_authorize.srf?"+A(c);return o}function Zc(c){var b=c!=null?c[B]:null;return b!=null&&b!=""?b:a._redirect_uri}var nf=function(b,a){this._state={};this._state[s]=b;this._state[f]=W;this._cookieName=a;this.init()};nf.prototype={get:function(a){return this._state[a]},save:function(){if(this._stateDirty){this._cookie.flush(this._state);this._stateDirty=false}},init:function(){var a=new Jb(this._cookieName);a.load();this._cookie=a;if(a.get(s)!=this._state[s]){a.clear();a.flush(this._state)}else this._state=a.getStates();var b=this._state[f];this._statusChecked=b!==Mb&&b!==W;this._cookie.addCookieChanged(i(this,this.onCookieChanged))},refresh:function(){a.getLoginStatus({internal:true},true);this._refresh=undefined},scheduleRefresh:function(){this.cancelRefresh();var a=(this.tokenExpiresIn()-600)*1000;if(a>0)this._refresh=window.setTimeout(i(this,this.refresh),a)},cancelRefresh:function(){if(this._refresh){window.clearTimeout(this._refresh);this._refresh=undefined}},updateStatus:function(a){var b=this._state[f],d=this._state[e];if(b!=a){this._state[f]=a;this._stateDirty=true;this.onStatusChanged(b,a);this.save();if(d!=this._state[e])c.notify(bb,this.getNormalStatus())}},onStatusChanged:function(b,a){k("AuthSession: Auth status changed: "+b+"=>"+a);if(b!=a){var g=b==H,d=a==H;if(!d){for(var e=0;e<nc.length;e++){var f=nc[e];if(this._state[f])delete this._state[f]}this._stateDirty=true;this.save()}if(Oc(b)!=Oc(a))c.notify(Nc,this.getNormalStatus());if(d!=g)if(d)c.notify(ic,this.getNormalStatus());else c.notify(bd,this.getNormalStatus())}},isSignedIn:function(){return this._state[f]===H},getNormalStatus:function(){var a=this.getStatus();a[f]=Oc(a[f]);return a},tokenExpiresIn:function(){var a=this._state,c=a[f],b=parseInt(a[pb]);if(c===H)return b-Ne();return -1},onCookieChanged:function(){var b=this._state,a=this._cookie.getStates();this._state=a;k("AuthSession: cookie changed. Has token: "+(a[e]!=null));this._statusChecked=a[f]!==W;if(b[e]!=a[e]||b[m]!=a[m]||b[w]!=a[w]){c.notify(cc);delete a[m];delete a[G];this._stateDirty=true}if(b[f]!=a[f])this.onStatusChanged(b[f],a[f]);if(b[e]!=a[e]){c.notify(bb,this.getNormalStatus());if(a[e])this.scheduleRefresh();else this.cancelRefresh()}this.save()},getStatus:function(){var b=null,c=this._state[f],j=null;if(c===H){var h=this.tokenExpiresIn();if(h<=10){c=this._statusChecked?Mb:W;this.updateStatus(c);window.setTimeout(function(){a.getLoginStatus({internal:true},true)},30000)}else{if(h<60)c=yc;b={};b[e]=this._state[e];b[tc]=this._state[tc];var i=this._state[g].split(" ");b[g]=[];for(var d=0;d<i.length;d++){var k=gh.exec(i[d]);if(k)j=k[1].split("_").join(".");else b[g].push(i[d])}this._state[g]=b[g].join(" ");b[mb]=h;b[pb]=this._state[pb]}}else if(!this._statusChecked)c=W;return {status:c,session:b,resource_id:j}},tryGetResponse:function(b,d,i){k("AuthSession.tryGetResponse: requestTs = "+d+" scope = "+b);var a=this.getStatus(),h=a[f],n=a[df];session=a[sf];if(h==W||h==yc)return null;if(d===undefined)if(b)return session&&Ue(session[g],b)?a:null;else return a;var e=this._state,j=parseInt(e[w]),c=e[m],l=e[G];if(j>=d){if(session&&(!c&&i||Ue(session[g],b)))return a;if(c)return Sh(c,l);if(!b)return a}return null}};function Ue(e,a){if(a==null||Y(a)=="")return true;var c=a.split(Jh);for(var b=0;b<c.length;b++){var d=Y(c[b]);if(d!=""&&!ei(e,d))return false}return true}function Oc(a){return a===W?Mb:a===yc?H:a}function Gh(a){if(Lg(a))return;if(hh(a))return;if(Kg(a))return;var b={};b[oc]=M;b[fc]=Wd;a.onCompleted(b)}function ri(){return window.XMLHttpRequest&&(new XMLHttpRequest).withCredentials!==undefined}function Me(){return a[lb]}function Te(){return a[U]}function bg(a){j(a,[{name:D,type:b,optional:false}],a[h])}function Uh(a){var b=a._properties,c=b[D];Mg(c,a)}var Mg=function(){var a=null,b=1;return function(c){var d={};d[ii]=b;c=ge(c,d);if(a===null){var e=Rc();a=Ce(c,e)}else a.src=c}}();a.jsonp={};WL.Internal.jsonp=a.jsonp;function Lg(c){var i=document.getElementsByTagName("HEAD")[0],b=document.createElement("SCRIPT"),d=Je(c._properties,d,[u,D]),f=c._id,g=Tc();if(g!=null)d[e]=g;d[u]=Df+f;d[fe]="true";var h=wb(c._url,d);if(h.length>ve)return false;c.scriptTag=b;a.jsonp[f]=function(a){Uc(f,b);c.onCompleted(a)};qh(b,c);b.setAttribute("async","async");b.type="text/javascript";b.src=h;i.appendChild(b);window.setTimeout(function(){if(c._completed)return;Uc(f,b)},30000);return true}function qh(b,c){if(a._browser.ie&&b.attachEvent)b.attachEvent("onreadystatechange",function(a){jd(a,c)});else{b.readyState="complete";b.addEventListener("load",function(a){jd(a,c)},false);b.addEventListener("error",function(a){jd(a,c)},false)}}function jd(d,c){if(c._completed)return;var b=d.srcElement||d.currentTarget;if(!b.readyState)b=d.currentTarget;if(b.readyState!="complete"&&b.readyState!="loaded")return;var f=c._id;failure=d.type=="error"||a.jsonp[f]!=null;if(failure){Uc(f,c.scriptTag);var e={};e[oc]=wg;e[fc]=ae;c.onCompleted({error:e})}}function Uc(b,c){delete a.jsonp[b];document.getElementsByTagName("HEAD")[0].removeChild(c)}function Kg(b){li();if(a._browser.flashVersion<9)return false;a.xdrFlash.send(b);return true}a.xdrFlash={_id:"",_status:cd,_flashObject:null,_requests:{},_pending:[],init:function(){if(this._status!=cd)return;this._status=hg;var c=bc("div");c.id="wl_xdr_container";document.body.appendChild(c);this._id=Rc();var b=zg,d=a[I]+"XDR.swf";b=b.replace(/{url}/g,d);b=b.replace(/{id}/g,this._id);b=b.replace(/{variables}/g,"domain="+document.domain);c.innerHTML=b},onReady:function(b){if(b){if(a._browser.firefox)this._flashObject=document.embeds[this._id];else this._flashObject=jb(this._id);this._status=Yd}else this._status=xh;while(this._pending.length>0)this.send(this._pending.shift())},onRequestCompleted:function(b,e,c,f){var d=a.xdrFlash._requests[b];delete a.xdrFlash._requests[b];ad(d,e,Th(c),f)},send:function(a){if(this._status<Yd){this._pending.push(a);if(this._status==cd)Ab(i(this,this.init));return}if(this._flashObject!=null){this._requests[a._id]=a;var b=Pe(a);this.invoke("send",[a._id,b.url,b.method,b.body])}else ad(a,0,null,ng)},invoke:function(d,a){a=a||[];var c=window.__flash__argumentsToXML(a,0),e='<invoke name="'+d+'" returntype="javascript">'+c+"</invoke>",b=this._flashObject.CallFunction(e);if(b==null)return null;return eval(b)}};WL.Internal.xdrFlash=a.xdrFlash;function Th(a){return a?a.replace(/\r/g," ").replace(/\n/g," "):a}var zg="<object classid='clsid:d27cdb6e-ae6d-11cf-96b8-444553540000' codebase='https://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,0,0' width='300' height='300' id='{id}' name='{id}' type='application/x-shockwave-flash' data='{url}'>"+"<param name='movie' value='{url}'></param>"+"<param name='allowScriptAccess' value='always'></param>"+"<param name='FlashVars' value='{variables}'></param>"+"<embed play='true' menu='false' swLiveConnect='true' allowScriptAccess='always' type='application/x-shockwave-flash' FlashVars='{variables}' src='{url}' width='300' height='300' name='{id}'></embed>"+"</object>",Vc=null;(function(){a.fileDialog=function(b){C(b[h]);if(a._pendingPickerOp!=null)throw new Error(Af);return (new Vc(b)).execute()};var g=0,b=1,f=2,d=3;Vc=function(c){var b=this;b._props=c;b._startTs=(new Date).getTime();c[Ub]=c[Ub]||Ec;c[S]=c[S]||ab;b._state=g;b._authDelegate=i(b,b._onAuthResp);a._pendingPickerOp=b};Vc.prototype={execute:function(){var a=this,b=new o(a._props[h],a,null);a._promise=b;a._process();return b},cancel:function(a){var b=this;if(b._state===d)return;if(!a)a=l(Eb,gc.replace(p,b._props[h]));b._onComplete(a)},_process:function(){var a=this;switch(a._state){case g:a._validateAuth();break;case b:a._initPicker();break;case f:a._complete()}},_changeState:function(c,b){var a=this;if(a._state!==d&&a._state!==c){a._state=c;if(b)a._result=b;a._process()}},_onComplete:function(a){this._changeState(f,a)},_validateAuth:function(){var c=this,e=false;if(a._rpsAuth)c._changeState(b);else{var d="";switch(c._props[x]){case P:d=ci;break;case Hc:d=Xg;break;case sb:case rb:d=c._buildExternalScope();e=true;break;default:var i=Xd.replace(p,Bb).replace(Ob,x);c._onComplete(l(Rg,i));return}var g=c._props[h],f=650;if(e)a.login({scope:d,external_consent:true}).then(function(a){c._onExternalConsentComplete(a)},function(a){c._onComplete(a)});else{d+=" "+lf;a.ensurePermission(d,f,g,c._authDelegate)}}},_buildExternalScope:function(){var b=this,a="onedrive_onetime.access:";switch(b._props[x]){case sb:a+=sb;break;case rb:a+=rb}switch(b._props[Hd]){case Rb:a+="file|";break;case Qb:a+="folder|";break;default:a+="file|"}a+=b._props[S]===ab?ab:Gc;if(b._props[Jc])a+="|"+b._props[Jc];return a},_onAuthResp:function(c){var a=this;if(c.error){if(!a._channel)a._onComplete(c)}else{var d=c.session[e];a._props[e]=d;if(a._channel)a._channel.send(FILEDIALOG_CHCMD_UPDATETOKEN,d);else a._changeState(b)}},_initPicker:function(){var b=this,d=b._props;m(d);b._channel=a.channel.registerOuterChannel(ug,xd(d.url).host,d.frame.contentWindow,d.url,i(b,b._onMessage));c.subscribe(bb,b._authDelegate);var e=function(a){if(a.keyCode===mi)b.cancel()};d.keydownHandler=e;v(window,"keydown",e);b._initTimeout()},_initTimeout:function(){var a=this;timeoutSeconds=a._props[Cd];if(timeoutSeconds&&timeoutSeconds>0)a._timeout=window.setTimeout(i(a,a._onTimeout),timeoutSeconds*1000)},_onTimeout:function(){var a=this,b=a._channel._connected;if(!b)a.cancel(l(pc,dg));a._clearTimeout()},_clearTimeout:function(){var a=this;if(a._timeout){window.clearTimeout(a._timeout);a._timeout=undefined}},_complete:function(){var b=this,c=b._result,e=c.error?r:q;b._state=d;b._cleanup();b._normalizeResp();if(b._props[h]===Bb)F(b._props[u],c,true);else if(c.data)F(b._props[Md],c,true);else F(b._props[Fb],c,true);b._promise[e](c);if(!a._rpsAuth)Kb(function(){b._report()})},_report:function(){var e=this._props,b=this._result,k=((new Date).getTime()-this._startTs)/1000,i="none",c=0,d=0;if(b.data){if(b.data.folders!=null)c=b.data.folders.length;if(b.data.files!=null)d=b.data.files.length}i=c>0&&d>0?"both":c>0?Qb:d>0?Rb:"none";var j=c+d,g={client:UI_SKYDRIVEPICKER,api:e[h],mode:e[x],select:e[S],result:b.error?b.error.code:"success",duration:k,object_selected:i,selected_count:j},f=a[dc];a.api({path:"web_analytics",method:dd,body:g});if(f)f(g)},_onExternalConsentComplete:function(c){var b=this;if(c.error){b._onComplete(c);return}var d=c[df];if(d==null){b._onComplete(l(M,"Did not get expected resource id."));return}a.api({path:d+"/files",method:kc,interface_method:b._props[h]}).then(function(a){b._onComplete(a)},function(a){b._onComplete(a)})},_onMessage:function(a,b){qb(a);switch(a){case FILEDIALOG_CHCMD_ONCOMPLETE:this._onComplete(b)}},_normalizeResp:function(){var e=this,g=e._props[x]===P,b=e._result.data,d=e._result.error,f=function(c){var b=c.upload_location;if(b)c.upload_location=b.replace("WL_APISERVICE_URL",a[U])};if(b){if(b.folders)for(var c=0;c<b.folders.length;c++)f(b.folders[c]);if(b.files)for(var c=0;c<b.files.length;c++)f(b.files[c])}if(d&&d.message)d.message=d.message.replace(p,e._props[h])},_cleanup:function(){var d=this,b=d._props,g=d._channel,f=b.resizeHandler,e=b.keydownHandler;d._clearTimeout();c.unsubscribe(bb,d._authDelegate);if(b.lightBox){b.frame.style.display=Se;b.lightBox.style.display=Se;document.body.removeChild(b.frame);document.body.removeChild(b.lightBox);delete b.lightBox;delete b.frame}if(g){g.dispose();delete d._channel}if(f)E(window,"resize",f);if(e)E(window,"keydown",e);delete a._pendingPickerOp}};function m(c){var f=c[x]===P,e=f?800:500,d=f?600:450,g=c[Ub],n=g===yd,i=n?0:60,o=g===Ec?"white":"rgb(0,0,0)",l=i/100,h=j(e,d),m=k(c),b=document.createElement("div");b.style.top="0px";b.style.left="0px";b.style.position="fixed";b.style.width="100%";b.style.height="100%";b.style.display="block";b.style.backgroundColor=o;b.style.opacity=l;b.style.MozOpacity=l;b.style.filter="alpha(opacity="+i+")";b.style.zIndex="2600000";var a=document.createElement("iframe");a.id="picker"+(new Date).getTime();a.style.top=h.top;a.style.left=h.left;a.style.position="fixed";a.style.width=e+"px";a.style.height=d+"px";a.style.display="block";a.style.zIndex="2600001";a.style.borderWidth="1px";a.style.borderColor="gray";a.style.maxHeight="100%";a.style.maxWidth="100%";a.src=m;a.setAttribute("sutra","picker");document.body.appendChild(a);document.body.appendChild(b);c.resizeHandler=function(){var b=j(e,d);a.style.top=b.top;a.style.left=b.left};v(window,"resize",c.resizeHandler);c.lightBox=b;c.frame=a;c.url=m}function k(d){var f=d[x]===P,g=f?Cf:Bf,b={},c=bf()+a[FILEDIALOG_PARAM_PICKER_SCRIPT];if(c.charAt(0)==="/")c=xc+c;b[gg]=g;b[Sg]=a._rpsAuth?fg:Vf;b[yg]=window.location.hostname.toLowerCase();b[qg]=c;b[s]=a._appId;b[w]=(new Date).getTime();b[bh]=a._locale;if(!a._rpsAuth)b[e]=d[e];if(f)b[S]=d[S];return wb(a[V],b)}function j(f,e){var b,c;if(a._browser.ie){var d=document.documentElement;b=(d.clientWidth-f)/2;c=(d.clientHeight-e)/2}else{b=(window.innerWidth-f)/2;c=(window.innerHeight-e)/2}b=b<10?10:b;c=c<10?10:c;return {left:b+"px",top:c+"px"}}})();var cf=60*1000;gd.prototype._getStrategy=function(e){var f=this,c=e[h],a=e[gb],i=e[zb];j(e,[{name:gb,type:Ac,optional:false}],c);if(typeof a===b)a=document.getElementById(a);if(!(a instanceof HTMLInputElement)||a.type!==wd)throw cb(gb,c,'It must be an HTMLInputElement with its type attribute set to"file" (i.e., <input type="file" />).');if(a.value==="")throw cb(gb,c,"It did not contain a selected file.");if(a.files&&window.FileReader){if(a.files.length!==1)throw cb(gb,c,"It must contain one selected file.");var g=a.files[0];f.setFileName(i||g.name);return new Lh(f,g)}if(a.name==="")a.name=wd;var d=null;if(a.form===null)d="It must be a child of an HTMLFormElement.";else if(a.form.length!==1)d="It must be the only HTMLInputElement in its parent HTMLFormElement.";else if(a.name!==wd)d='Its name attribute must be set to "file" (i.e., <input name="file" />).';if(d!==null)throw cb(gb,c,d);return new Od(f,a,c)};function Od(b,d,c){var a=this;a._op=b;a._iMethod=c;a._element=d;a._uploadIFrame=null;a._uploadTimeoutId=null;b.setFileName(undefined)}Od.prototype={getId:function(){var a=this;if(a._uploadIFrame===null)a._createUploadIFrame();return a._uploadIFrame.id},setUploadTimeout:function(){var a=this;a._uploadTimeoutId=window.setTimeout(function(){a.onTimeout()},cf)},clearUploadTimeout:function(){var a=this;if(a._uploadTimeoutId===null)return;window.clearTimeout(a._uploadTimeoutId);a._uploadTimeoutId=null},onTimeout:function(){var a=this;a._uploadTimeoutId=null;var b=a._iMethod+": did not receive a response in "+cf+" milliseconds.",c=l(pc,b);a._op.uploadComplete(false,c)},onUploadComplete:function(a){var b=this;b.clearUploadTimeout();b._removeUploadIFrame();a=fd(a);var d=a.error,c=typeof d===kb;b._op.uploadComplete(c,a)},upload:function(a){this._multiPartFormUpload(a)},_getRequestUrl:function(d){var b={};b[B]=a._redirect_uri;var c={};c[vc]=re;c[Ze]=this.getId();b[Z]=A(c);return wb(d,b)},_createUploadIFrame:function(){var a=this;if(a._uploadIFrame!==null)return;a._uploadIFrame=bc("iframe");a._uploadIFrame.name=a._uploadIFrame.id=Rc();document.body.appendChild(a._uploadIFrame)},_multiPartFormUpload:function(c){var a=this;a._createUploadIFrame();var b=a._getRequestUrl(c);a._submitForm(b);a.setUploadTimeout();Cb.add(a);rg()},_removeUploadIFrame:function(){var a=this;if(a._uploadIFrame===null)return;a._uploadIFrame.parentNode.removeChild(a._uploadIFrame);a._uploadIFrame=null},_submitForm:function(c){var b=this,a=b._element.form;a.target=b._uploadIFrame.name;a.method=dd;a.enctype="multipart/form-data";a.action=c;a.submit()}};function Bd(){this._pendingUploads={}}Bd.prototype={add:function(a){var b=a.getId();this._pendingUploads[b]=a},hasPendingUploads:function(){for(var a in this._pendingUploads)return true;return false},isPending:function(a){return a in this._pendingUploads},get:function(a){return this._pendingUploads[a]},remove:function(a){delete this._pendingUploads[a]}};var Cb=new Bd,rg=function(){var b=false,a=new Jb(ff),c=function(){var d=a.getStates(),c=false;for(var b in d){if(!Cb.isPending(b))continue;var f=d[b],e=Cb.get(b);Cb.remove(b);a.remove(b);c=true;e.onUploadComplete(f)}if(!Cb.hasPendingUploads())a.stopMonitor();if(c){a.save();c=false}};return function(){if(a.isBeingMonitored())return;if(b)a.startMonitor();else{a.addCookieChanged(c);b=true}}}();function Lh(a,b){this.upload=function(d){var c=null;if(window.File&&b instanceof window.File)c=new FileReader;c.onerror=function(b){error=b.target.error;a.onErr(error.name)};c.onload=function(e){var c=e.target.result,b=new XMLHttpRequest;b.open(Wh,d,true);b.onload=function(b){a.onResp(b.currentTarget.responseText)};b.onerror=function(b){a.onErr(b.currentTarget.statusText)};if(b.upload)b.upload.onprogress=function(b){if(b.lengthComputable){var c={bytesTransferred:b.loaded,totalBytes:b.total,progressPercentage:b.total===0?0:b.loaded/b.total*100};a.uploadProgress(c)}};a._cancel=i(b,b.abort);b.send(c)};c.readAsArrayBuffer(b)}}function Eg(){a._isHttps=document.location.protocol.toLowerCase()==xc}function li(){if(a._browser.flash!==undefined)return;var b=0;try{if(a._browser.ie){var k=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),f=k.GetVariable("$version"),i=f.split(" "),g=i[1],d=g.split(",");b=d[0]}else if(navigator.plugins&&navigator.plugins.length>0)if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var j=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"",e=navigator.plugins["Shockwave Flash"+j].description,h=e.split(" "),c=h[2].split(".");b=c[0]}}catch(l){}a._browser.flashVersion=b;a._browser.flash=b>=8}function Xh(){if(a._documentReady===undefined)a._documentReady=(new Date).getTime()}function nh(b){Ab(function(){if(a._browser.firefox&&(!a._documentReady||(new Date).getTime()-a._documentReady<1000))window.setTimeout(b,1000);else b()})}function Ab(b){if(document.body)switch(document.readyState){case "complete":b();return;case "loaded":if(a._browser.webkit){b();return}break;case "interactive":case undefined:if(a._browser.firefox||a._browser.webkit){b();return}}if(document.addEventListener){document.addEventListener("DOMContentLoaded",b,false);document.addEventListener("load",b,false)}else if(window.attachEvent)window.attachEvent("onload",b);if(a._browser.ie&&document.attachEvent)document.attachEvent("onreadystatechange",function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",arguments.callee);b()}})}function mf(b,a){b.innerHTML=a}function v(a,b,c){if(a.addEventListener)a.addEventListener(b,c,false);else if(a.attachEvent)a.attachEvent("on"+b,c)}function E(a,b,c){if(a.removeEventListener)a.removeEventListener(b,c,false);else if(a.detachEvent)a.detachEvent("on"+b,c)}function yh(){var a=jb(sd);if(a){var b=a.getAttribute(Ke);!b&&n(pd("Could not find attribute '{0}' on element with id '{1}'.",Ke,sd),ONEDRIVE_PREFIX);return b}else{n(pd("Could not find element with id '{0}'.",sd),ONEDRIVE_PREFIX);return null}}var hd={registerOuterChannel:function(e,b,c,d,a){return J.registerChannel(e,b,c,d,a)},registerInnerChannel:function(c,b,a){return J.registerChannel(c,b,null,null,a)},isSupported:function(){return J.isSupported()}},J={_channels:[],isSupported:function(){return window.postMessage!=null},registerChannel:function(h,e,f,g,d){var b=J,c=b._channels,a=null;if(b.isSupported()){a=new Ee(h,e,f,g,d);if(c.length===0)v(window,"message",b._onMessage);c.push(a)}return a},unregisterChannel:function(d){var c=J,a=c._channels;for(var b=0;b<a.length;b++)if(a[b]==d){a.splice(b,1);break}if(a.length===0)E(window,"message",c._onMessage)},_onMessage:function(a){var d=J,a=a||window.event,c=Yh(a);if(c!=null){var b=d._findChannel(a,c);if(b!=null)switch(c.text){case pf:b._onConnectReq(a.source,a.origin);break;case of:b._onConnectAck(a.source);break;default:b._onMessage(c.text)}}},_findChannel:function(g,f){var d=J,c=d._channels,e=gi(g.origin);for(var b=0;b<c.length;b++){var a=c[b];if(Td(a._name,f.name)&&Td(a._allowedDomain,e))return a}return null}},pf="@ConnectReq",of="@ConnectAck";function Ee(f,d,b,e,c){var a=this;a._name=f;a._allowedDomain=d;a._msgHandler=c;if(b){a._targetWindow=b;a._targetUrl=Vh(e);a._connect()}}Ee.prototype={_disposed:false,_connected:false,_allowedDomain:null,_targetWindow:null,_targetUrl:null,_msgHandler:null,_connectSchedule:-1,_pendingQueue:[],_recvQueue:[],dispose:function(){var a=this;if(!a._disposed){a._disposed=true;a._cancelConnect();J.unregisterChannel(a)}},send:function(c,d){var a=this;if(a._disposed)return;var b=Zg(c,d);if(a._connected)a._post(b);else a._pendingQueue.push(b)},_connect:function(){var a=this;if(a._disposed||a._connected)return;var b=function(){a._post(pf)};if(a._connectSchedule===-1){a._connectSchedule=window.setInterval(b,500);b()}},_post:function(b){var a=this,c=Fh(a._name,b);a._targetWindow.postMessage(c,a._targetUrl)},_onConnectReq:function(c,b){var a=this;if(!a._connected){a._connected=true;a._targetWindow=c;a._targetUrl=b;a._post(of);a._onConnected()}},_onConnectAck:function(b){var a=this;if(!a._connected){a._targetWindow=b;a._onConnected()}},_onConnected:function(){var a=this,c=a._pendingQueue;a._connected=true;for(var b=0;b<c.length;b++)a._post(c[b]);a._pendingQueue=[];a._cancelConnect()},_cancelConnect:function(){var a=this;if(a._connectSchedule!=-1){window.clearInterval(a._connectSchedule);a._connectSchedule=-1}},_onMessage:function(b){if(this._msgHandler){var a=Yg(b);this._msgHandler(a.cmd,a.args)}}};function Vh(b){var a=b.indexOf("://");if(a>=0){a=b.indexOf("/",a+3);if(a>=0)b=b.substring(0,a)}return b}function Yh(a){var b=null;if(!ze(a.origin)&&!ze(a.data)&&a.source!=null)b=Eh(a.data);return b}function Fh(a,b){return "<"+a+">"+b}function Eh(a){var c=null;if(a.charAt(0)=="<"){var b=a.indexOf(">");if(b>0){var d=a.substring(1,b),e=a.substr(b+1);c={name:d,text:e}}}return c}function Zg(a,c){var b={cmd:a,args:c};return JSON.stringify(b)}function Yg(b){var a=JSON.parse(b);return a}if(window.WL)a.channel=hd;else window.WL={channel:hd};var z={connect:"Connect",signIn:"Sign in",signOut:"Sign out",login:"Log in",logout:"Log out",skyDriveOpenPickerButtonText:"Open from OneDrive",skyDriveOpenPickerButtonTooltip:"Open from OneDrive",skyDriveSavePickerButtonText:"Save to OneDrive",skyDriveSavePickerButtonTooltip:"Save to OneDrive"};a._locale="en";a[R]="Web/DEVICE_"+Ng("5.5.8527.3005");a.testInit=function(b){if(b.env)a._settings.init(b.env);if(b.skydrive_uri)a._settings[V]=b.skydrive_uri;if(b[dc])a[dc]=b[dc]};var Hb={};Hb[lb]="login.live.com";Hb[U]="https://apis.live.net/v5.0/";Hb[V]="https://onedrive.live.com/";Hb[I]="//js.live.net/v5.0/";var Nb={};Nb[lb]="login.live.com";Nb[U]="https://df.apis.live.net/v5.0/";Nb[V]="https://onedrive.live.com/";Nb[I]="//df-js.live.net/v5.0/";var Lb={};Lb[lb]="login.live-int.com";Lb[U]="https://apis.live-int.net/v5.0/";Lb[V]="https://onedrive.live-int.com/";Lb[I]="//js.live-int.net/v5.0/";var Gb={};Gb[lb]="login.live-int.com";Gb[U]="https://current.apis.live-tst.net/v5.0/";Gb[V]="https://onedrive.live-int.com/";Gb[I]="//current-js.live-int.net/v5.0/";var Ib={};Ib[lb]="login.live-int.com";Ib[U]="https://bvt.apis.live-tst.net/v5.0/";Ib[V]="https://onedrive-bvt.live-int.com/";Ib[I]="//bvt-js.live-int.net/v5.0/";a._settings={PROD:Hb,DF:Nb,INT:Lb,CURRENT:Gb,BVT:Ib,init:function(b){b=b.toUpperCase();var c=this[b];if(c)t(c,a)}};a._settings.init("PROD");a[FILEDIALOG_PARAM_PICKER_SCRIPT]="wl.skydrivepicker.js";a.onloadInit()}})();